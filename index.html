<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VIRAL NEWS</title>
<meta name="description" content="Viral News – Latest headlines from around the world">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #1f1f1f;
  color: #fff;
}

header {
  background: #0b1c2d;
  padding: 16px;
  position: sticky;
  top: 0;
  z-index: 1000;
}

.menu-btn {
  font-size: 26px;
  cursor: pointer;
}

.logo {
  text-align: center;
  font-size: 30px;
  font-weight: bold;
  letter-spacing: 2px;
}

#menu {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  background: #111;
  width: 260px;
  height: 100%;
  padding: 20px;
  z-index: 2000;
}

#menu h3 {
  font-size: 16px;
  border-bottom: 1px solid #333;
  padding-bottom: 10px;
}

#menu a {
  display: block;
  color: #fff;
  padding: 10px 0;
  text-decoration: none;
  font-size: 14px;
  cursor: pointer;
}

#menu a:hover {
  color: #4da3ff;
}

#overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 1500;
}

main {
  padding: 20px;
  max-width: 900px;
  margin: auto;
}

.top-bar {
  display: none;
  margin-bottom: 15px;
}

.back-btn {
  cursor: pointer;
  color: #4da3ff;
  font-size: 14px;
}

.section-title {
  font-size: 14px;
  color: #aaa;
  margin-top: 30px;
  border-bottom: 1px solid #333;
  padding-bottom: 6px;
}

.article {
  padding: 12px 0;
  border-bottom: 1px solid #2f2f2f;
}

.article a {
  color: #fff;
  font-size: 17px;
  text-decoration: none;
}

.article a:hover {
  color: #4da3ff;
}

.time {
  font-size: 12px;
  color: #999;
  margin-top: 4px;
}
</style>
</head>

<body>

<header>
  <div class="menu-btn" onclick="openMenu()">☰</div>
  <div class="logo">VIRAL NEWS</div>
</header>

<div id="menu">
  <h3>Categories</h3>
  <a onclick="loadCategory('Breaking')">Breaking News</a>
  <a onclick="loadCategory('World')">World News</a>
  <a onclick="loadCategory('Politics')">Politics & Law</a>
  <a onclick="loadCategory('Finance')">Business & Finance</a>
  <a onclick="loadCategory('Tech')">Technology</a>
  <a onclick="loadCategory('Sports')">Sports</a>
  <a onclick="loadCategory('Entertainment')">Entertainment</a>
  <a onclick="loadCategory('Health')">Health & Science</a>
</div>

<div id="overlay" onclick="closeMenu()"></div>

<main>
  <div class="top-bar" id="topBar">
    <span class="back-btn" onclick="goHome()">← Home</span>
  </div>
  <div id="news"></div>
</main>

<script>
const CATEGORY_MAP = {
  Breaking: ["Breaking News"],
  World: ["World News","Africa","Asia","Europe","Middle East","South America","Local"],
  Politics: ["Politics","Government","Law","Public Safety","Opinion"],
  Finance: ["Stock","Economy","Finance","Crypto","Real Estate"],
  Tech: ["Artificial","Software","Gadgets","Cyber"],
  Sports: ["Sports","Soccer","Basketball","Cricket","Tennis","Olympics"],
  Entertainment: ["Celebrity","Movies","Music","TV","Influencer"],
  Health: ["Health","Science","Climate","Environment","Weather","Education"]
};

let allArticles = [];
let currentList = [];
let page = 0;
const PAGE_SIZE = 20;

function openMenu() {
  document.getElementById("menu").style.display = "block";
  document.getElementById("overlay").style.display = "block";
}
function closeMenu() {
  document.getElementById("menu").style.display = "none";
  document.getElementById("overlay").style.display = "none";
}

function normalize(cat) {
  return (cat || "").replace("(Alt)", "").trim();
}

function timeAgo(date) {
  const diff = (Date.now() - new Date(date)) / 1000;
  if (diff < 3600) return `${Math.floor(diff/60)}m`;
  if (diff < 86400) return `${Math.floor(diff/3600)}h`;
  return `${Math.floor(diff/86400)}d`;
}

async function loadHome() {
  const res = await fetch("https://viral-news-backend-3.onrender.com/articles/");
  allArticles = await res.json();
  document.getElementById("topBar").style.display = "none";
  renderNewList(allArticles, "Latest News");
}

function loadCategory(key) {
  closeMenu();
  document.getElementById("topBar").style.display = "block";
  const terms = CATEGORY_MAP[key];
  const filtered = allArticles.filter(a =>
    terms.some(t => normalize(a.category).includes(t))
  );
  renderNewList(filtered, key);
}

function goHome() {
  renderNewList(allArticles, "Latest News");
  document.getElementById("topBar").style.display = "none";
}

function renderNewList(list, title) {
  currentList = list;
  page = 0;
  const news = document.getElementById("news");
  news.innerHTML = `<div class="section-title">${title}</div>`;
  loadMore();
}

function loadMore() {
  const news = document.getElementById("news");
  const slice = currentList.slice(page * PAGE_SIZE, (page + 1) * PAGE_SIZE);
  slice.forEach(a => {
    if (!a.title) return;
    const clean = a.title.replace(/[\[\]\*\#\"\'\<\>]/g,"").trim();
    news.innerHTML += `
      <div class="article">
        <a href="articles.html?id=${a.id}">${clean}</a>
        <div class="time">• ${timeAgo(a.created_at)}</div>
      </div>
    `;
  });
  page++;
}

window.addEventListener("scroll", () => {
  if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 300) {
    loadMore();
  }
});

loadHome();
</script>

</body>
</html>
