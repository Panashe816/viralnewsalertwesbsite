<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VIRAL NEWS</title>
<meta name="description" content="Viral News – Latest headlines from all categories">

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background: #f4f4f4;
  }
  h1 {
    text-align: center;
    font-size: 2.2em;
    margin-bottom: 30px;
    color: #111;
  }
  h2.category-title {
    margin-top: 40px;
    color: #222;
    font-size: 1.4em;
    border-bottom: 2px solid #ddd;
    padding-bottom: 6px;
  }
  ul.headline-list {
    list-style: none;
    padding: 0;
    margin: 15px 0 30px 0;
  }
  li.headline-item {
    background: white;
    margin-bottom: 10px;
    padding: 12px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
  li.headline-item a {
    text-decoration: none;
    color: #000;
    font-weight: bold;
    flex: 1;
  }
  li.headline-item img {
    width: 110px;
    height: 70px;
    object-fit: cover;
    border-radius: 6px;
    flex-shrink: 0;
    background: #eee;
  }
</style>
</head>

<body>

<h1>VIRAL NEWS</h1>

<div id="news-container">Loading headlines…</div>

<script>
async function loadHeadlines() {
  const container = document.getElementById("news-container");
  container.innerHTML = "";

  try {
    const res = await fetch("https://viral-news-backend-3.onrender.com/articles/");
    const articles = await res.json();

    if (!articles || articles.length === 0) {
      container.innerHTML = "<p>No articles found.</p>";
      return;
    }

    const categories = {};

    articles.forEach(article => {
      // ❌ REMOVE untitled / empty headlines
      if (!article.title) return;

      let title = article.title
        .replace(/[\[\]\*\<\>\"\'\`]/g, "")
        .trim();

      if (
        title === "" ||
        title.toLowerCase().includes("untitled")
      ) return;

      const category = article.category || "General";

      if (!categories[category]) categories[category] = [];

      categories[category].push({
        id: article.id,
        title: title,
        image: article.image_url || "https://via.placeholder.com/110x70?text=No+Image"
      });
    });

    for (const [category, list] of Object.entries(categories)) {
      if (list.length === 0) continue;

      const h2 = document.createElement("h2");
      h2.className = "category-title";
      h2.textContent = category;
      container.appendChild(h2);

      const ul = document.createElement("ul");
      ul.className = "headline-list";

      list.forEach(a => {
        const li = document.createElement("li");
        li.className = "headline-item";
        li.innerHTML = `
          <a href="https://viral-news-backend-3.onrender.com/articles/${a.id}" target="_blank">
            ${a.title}
          </a>
          <img src="${a.image}" alt="Thumbnail">
        `;
        ul.appendChild(li);
      });

      container.appendChild(ul);
    }

  } catch (err) {
    console.error(err);
    container.innerHTML = "<p>Failed to load news.</p>";
  }
}

loadHeadlines();
</script>

</body>
</html>
